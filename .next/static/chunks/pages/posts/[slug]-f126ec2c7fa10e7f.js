(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[922],{592:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/[slug]",function(){return s(2791)}])},2413:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var n=s(4563);function a(e){return(0,n.Z)(e,{addSuffix:!0})}},2791:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSG:function(){return g},default:function(){return N}});var n=s(5893),a=s(1163),l=s(2918),i=s.n(l),r=s(8100);function c(e){let{text:t,setText:s,onSubmit:a}=e,{isAuthenticated:l,logout:i,loginWithPopup:c}=(0,r.D3)();return(0,n.jsxs)("form",{onSubmit:a,children:[(0,n.jsx)("textarea",{className:"flex w-full max-h-40 p-3 rounded resize-y bg-gray-200 text-gray-900 placeholder-gray-500",rows:2,placeholder:l?"What are your thoughts?":"Please login to leave a comment",onChange:e=>s(e.target.value),value:t,disabled:!l}),(0,n.jsx)("div",{className:"flex items-center mt-4",children:l?(0,n.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,n.jsx)("button",{className:"py-2 px-4 rounded bg-blue-600 text-white disabled:opacity-40 hover:bg-blue-700",children:"Send"}),(0,n.jsx)("button",{className:"text-gray-500",onClick:()=>i({returnTo:window.location.origin}),children:"Log Out"})]}):(0,n.jsx)("button",{type:"button",className:"py-2 px-4 rounded bg-blue-600 text-white disabled:opacity-40 hover:bg-blue-700",onClick:()=>c(),children:"Log In"})})]})}var o=s(2413),d=s(3454);function u(e){let{comments:t,onDelete:s}=e,{user:a}=(0,r.D3)();return(0,n.jsx)("div",{className:"space-y-6 mt-10",children:t&&t.map(e=>{let t=a&&a.sub===e.user.sub,l=a&&a.email===d.env.NEXT_PUBLIC_AUTH0_ADMIN_EMAIL;return(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("img",{src:e.user.picture,alt:e.user.name,width:40,height:40,className:"rounded-full"})}),(0,n.jsxs)("div",{className:"flex-grow",children:[(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("b",{children:e.user.name}),(0,n.jsx)("time",{className:"text-gray-400",children:(0,o.Z)(e.created_at)}),(l||t)&&(0,n.jsx)("button",{className:"text-gray-400 hover:text-red-500",onClick:()=>s(e),"aria-label":"Close",children:"x"})]}),(0,n.jsx)("div",{children:e.text})]})]},e.created_at)})})}var x=s(7294),h=s(9734);let m=e=>fetch(e).then(e=>e.json());function f(){let{text:e,setText:t,comments:s,onSubmit:a,onDelete:l}=function(){let{getAccessTokenSilently:e}=(0,r.D3)(),[t,s]=(0,x.useState)(""),{data:n,mutate:a}=(0,h.ZP)("/api/comment",m,{fallbackData:[]}),l=async n=>{n.preventDefault();let l=await e();try{await fetch("/api/comment",{method:"POST",body:JSON.stringify({text:t}),headers:{Authorization:l,"Content-Type":"application/json"}}),s(""),await a()}catch(e){console.log(e)}},i=async t=>{let s=await e();try{await fetch("/api/comment",{method:"DELETE",body:JSON.stringify({comment:t}),headers:{Authorization:s,"Content-Type":"application/json"}}),await a()}catch(e){console.log(e)}};return{text:t,setText:s,comments:n,onSubmit:l,onDelete:i}}();return(0,n.jsxs)("div",{className:"mt-20",children:[(0,n.jsx)(c,{onSubmit:a,text:e,setText:t}),(0,n.jsx)(u,{comments:s,onDelete:l})]})}var j=s(6935),p=s(9008),b=s.n(p),g=!0;function N(e){let{post:t}=e,s=(0,a.useRouter)();return s.isFallback||(null==t?void 0:t.slug)?(0,n.jsxs)(j.Z,{children:[(0,n.jsx)(b(),{children:(0,n.jsxs)("title",{children:[t.title," | My awesome blog"]})}),s.isFallback?(0,n.jsx)("div",{children:"Loadingâ€¦"}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("article",{children:[(0,n.jsxs)("header",{children:[(0,n.jsx)("h1",{className:"text-4xl font-bold",children:t.title}),t.excerpt?(0,n.jsx)("p",{className:"mt-2 text-xl",children:t.excerpt}):null,(0,n.jsx)("time",{className:"flex mt-2 text-gray-400",children:(0,o.Z)(new Date(t.date))})]}),(0,n.jsx)("div",{className:"prose mt-10",dangerouslySetInnerHTML:{__html:t.content}})]}),(0,n.jsx)(f,{})]})]}):(0,n.jsx)(i(),{statusCode:404})}}},function(e){e.O(0,[563,534,774,888,179],function(){return e(e.s=592)}),_N_E=e.O()}]);